<% environment = GovukPublishingComponents::AppHelpers::Environment.current_acceptance_environment %>
<%= render "govuk_publishing_components/components/layout_for_admin", {
  environment: environment,
  product_name: "Manuals Publisher",
  browser_title: yield(:title)
} do %>
  <%= render "govuk_publishing_components/components/skip_link", {
  } %>

  <%
    navigation_items = [
      { text: "Manuals", href: manuals_path },
      { text: "Whats new", href: "", active: true },
    ]

    if current_user
      navigation_items += [
        { text: current_user.name, href: Plek.external_url_for("signon") },
        { text: "Log out", href: gds_sign_out_path },
      ]
    end
  %>
  <%= render "govuk_publishing_components/components/layout_header", {
    environment: environment,
    navigation_items: navigation_items,
  } %>

  <div class="govuk-width-container">
    <%= render "govuk_publishing_components/components/phase_banner", {
      phase: "Beta"
    } %>

    <%= yield(:back_link) %>
    <%= yield(:breadcrumbs) %>

    <main class="govuk-main-wrapper<%= " govuk-main-wrapper--l" if yield(:back_link).blank? && yield(:breadcrumbs).blank?%>" id="main-content" role="main">
      <% if flash["notice"].present? %>
        <div data-module="auto-track-event" data-track-category="flash-message" data-track-action="alert-success" data-track-label="<%= flash["notice"] %>">
          <%= render "govuk_publishing_components/components/success_alert", {
            message: flash["notice"]
          } %>
        </div>
      <% end %>

      <% if flash["alert"].present? && yield(:error_summary).blank? %>
        <div data-module="auto-track-event" data-track-category="flash-message" data-track-action="alert-danger" data-track-label="<%= flash["alert"] %>">
          <%= render "govuk_publishing_components/components/error_alert", {
            message: flash["alert"].html_safe
          } %>
        </div>
      <% end %>
      <%= yield %>
    </main>
  </div>

  <%= render "govuk_publishing_components/components/layout_footer", {
    navigation: [
      {
        title: "Support and feedback",
        items: [
          {
            href: Plek.external_url_for("support"),
            text: "Raise a support request"
          },
          {
            href: "https://www.gov.uk/government/content-publishing",
            text: "How to write, publish, and improve content"
          }
        ]
      }
    ]
  } %>
<% end %>
