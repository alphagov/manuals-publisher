<% content_for :breadcrumbs do %>
  <li><%= link_to "Your documents", specialist_documents_path(resource_name) %></li>
  <li class='active'><%= document.title %></li>
<% end %>

<h1 class="page-header"><%= document.title %>
<% if document.publication_state == "published" %>
  <span class='document-slug'>
    <%= link_to document.slug, published_specialist_document_path(document) %>
  </span>
<% else %>
  <span class='document-slug' title='When published this document will appear at this URL'><%= document.slug %></span>
<% end %>
</h1>
<div class="row">
  <div class="col-md-8">
    <h2>Summary</h2>
    <p class="lead"><%= document.summary %></p>
  </div>
</div>
<div class="row add-bottom-margin">
  <div class=" col-md-8">
    <h2>Metadata</h2>
    <dl class="metadata-list">
      <% document.humanized_attributes.each_pair do |label, values| %>
        <dt><%= label.to_s.humanize %></dt>
        <% Array(values).each do |value| %>
          <dd><%= value %></dd>
        <% end %>
      <% end %>
      <dt>Publication state</dt>
      <dd><%= state(document) %></dd>
    </dl>
  </div>
</div>

<% if document.body.present? %>
  <div class="row">
    <div class="col-md-8">
      <h2>Body</h2>
      <pre class="body-pre add-bottom-margin"><%= document.body %></pre>
    </div>
  </div>
<% end %>

<div class="row">
  <div class=" col-md-8">
    <h2 class="add-bottom-margin">Attachments</h2>
    <% if document.attachments.any? %>
      <table class='table table-bordered table-striped'>
        <thead>
          <tr class="table-header">
            <th>Title</th>
            <th>Created</th>
            <th>Last updated</th>
          </tr>
        </thead>
        <% document.attachments.each do | attachment | %>
        <tr>
          <td><%= attachment.title %></td>
          <td><%= attachment.created_at.to_s(:govuk_date)%></td>
          <td><%= attachment.updated_at.to_s(:govuk_date)%></td>
        </tr>
        <% end %>
      </table>
    <% else %>
      <p class='no-content-message'>This document doesn't have any attachments</p>
    <% end %>
  </div>
</div>

<div class="actions">
  <%= publish_form(slug_unique, publishable, document) %>

  <% if current_user_can_withdraw?(document.document_type) %>
    <%= form_tag([:withdraw, document], method: :post) do %>
      <button name='submit' class="btn btn-danger">Withdraw</button>
    <% end -%>
  <% end %>

  <%= link_to "Edit", [:edit, document], class: "btn btn-primary" %>
</div>
